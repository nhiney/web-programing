@model WebBanGIay.Models.HOADON
@{
    ViewBag.Title = "Cập nhật trạng thái đơn hàng";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="container py-4" style="color:#d8e5f7; max-width: 700px;">
    <div class="card bg-dark border-secondary shadow">
        <div class="card-header border-secondary bg-warning text-dark">
            <h4 class="mb-0 fw-bold"><i class="bi bi-pencil-square"></i> Cập nhật trạng thái đơn hàng</h4>
        </div>
        <div class="card-body">
            
            <!-- Order Info (Read-only) -->
            <div class="mb-3 p-3 bg-secondary bg-opacity-25 rounded">
                <div class="row">
                    <div class="col-6">
                        <strong>Mã đơn:</strong> @Model.MAHOADON
                    </div>
                    <div class="col-6">
                        <strong>Ngày lập:</strong> @Model.NGAYLAP?.ToString("dd/MM/yyyy")
                    </div>
                </div>
                <div class="mt-2">
                    <strong>Khách hàng:</strong> @(Model.KHACHHANG?.HOTEN ?? "Khách vãng lai")
                </div>
                <div class="mt-2">
                    <strong>Tổng tiền:</strong> <span class="text-success fw-bold">@string.Format("{0:N0}", Model.TONGTIEN) đ</span>
                </div>
            </div>

            <!-- Status Update Form -->
            <form method="post" action="@Url.Action("UpdateStatus")">
                @Html.AntiForgeryToken()
                <input type="hidden" name="id" value="@Model.MAHOADON" />

                <div class="mb-4">
                    <label class="form-label fw-bold">Trạng thái hiện tại</label>
                    <div>
                        @{
                            string badgeClass = "bg-secondary";
                            if (Model.TRANGTHAI == "HOÀN THÀNH") { badgeClass = "bg-success"; }
                            else if (Model.TRANGTHAI == "CHỜ XỬ LÝ") { badgeClass = "bg-warning text-dark"; }
                            else if (Model.TRANGTHAI == "ĐÃ GIAO") { badgeClass = "bg-info text-dark"; }
                            else if (Model.TRANGTHAI == "ĐÃ HỦY") { badgeClass = "bg-danger"; }
                        }
                        <span class="badge @badgeClass fs-6">@Model.TRANGTHAI</span>
                    </div>
                </div>

                <div class="mb-4">
                    <label class="form-label fw-bold">Cập nhật trạng thái mới</label>
                    <select name="status" class="form-select form-select-lg bg-dark text-light border-secondary" required>
                        <option value="">-- Chọn trạng thái --</option>
                        <option value="CHỜ XỬ LÝ" @(Model.TRANGTHAI == "CHỜ XỬ LÝ" ? "selected" : "")>CHỜ XỬ LÝ</option>
                        <option value="ĐÃ GIAO" @(Model.TRANGTHAI == "ĐÃ GIAO" ? "selected" : "")>ĐÃ GIAO (Đang ship)</option>
                        <option value="HOÀN THÀNH" @(Model.TRANGTHAI == "HOÀN THÀNH" ? "selected" : "")>HOÀN THÀNH</option>
                        <option value="ĐÃ HỦY" @(Model.TRANGTHAI == "ĐÃ HỦY" ? "selected" : "")>ĐÃ HỦY</option>
                    </select>
                </div>

                <div class="d-grid gap-2">
                    <button type="submit" class="btn btn-warning fw-bold py-2">
                        <i class="bi bi-check-circle"></i> Lưu thay đổi
                    </button>
                    <a href="@Url.Action("Details", new { id = Model.MAHOADON })" class="btn btn-outline-secondary">
                        Hủy bỏ
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>
